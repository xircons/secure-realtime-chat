:root {
  --bg: #0f1115;
  --bg-soft: #151922;
  --panel: #1a2030;
  --panel-2: #20283b;
  --border: #2b3450;
  --text: #e7ecff;
  --muted: #9aa7c7;
  --primary: #5b77ff;
  --primary-600: #4b67ef;
  --danger: #ff6b6b;
  --success: #36d399;
}

html, body, button, input, textarea, select {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
}

.login-container { display:flex; align-items:center; justify-content:center; min-height:100vh; padding: 24px; background: radial-gradient(1200px 600px at -10% -10%, #1b2030, transparent), radial-gradient(800px 400px at 120% 10%, #1c2440, transparent), var(--bg); }
.login-card { width:100%; max-width:400px; display:flex; flex-direction:column; gap:14px; background:linear-gradient(180deg, var(--panel), var(--panel-2)); padding:28px; border-radius:16px; border:1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
.login-card h1 { margin:0; font-size:22px; color:var(--text); }
.login-card p.small { margin:0 0 8px; color:var(--muted); font-size:13px; }
.login-card input[type="file"], .login-card input[type="text"], .login-card input:not([type]) { padding:12px; border-radius:10px; border:1px solid var(--border); background:var(--bg-soft); color:var(--text); }
.login-card input:focus { outline: 2px solid var(--primary); border-color: var(--primary); }
.login-card button { padding:12px; border-radius:10px; border:1px solid transparent; background:linear-gradient(180deg, var(--primary), var(--primary-600)); color:#fff; font-weight:600; cursor:pointer; }
.login-card button:hover { filter: brightness(1.05); }
.login-card .error { color:var(--danger); font-size:13px; }
.login-card .switch { font-size:14px; color:var(--muted) }

.dashboard { display:flex; height:100vh; overflow:hidden; background: var(--bg); color: var(--text); }
.sidebar { width:320px; max-width:100%; padding:16px; border-right:1px solid var(--border); display:flex; flex-direction:column; gap:16px; background: linear-gradient(180deg, var(--panel), var(--panel-2)); overflow:auto; }
.sidebar h2 { margin: 8px 0 0; font-size:14px; color: var(--muted); letter-spacing: .08em; text-transform: uppercase; }
.profile { display:flex; align-items:center; gap:12px; padding:12px; background: var(--bg-soft); border:1px solid var(--border); border-radius:12px; }
.profile img, .avatar { width:40px; height:40px; border-radius:50%; object-fit:cover; }
.avatar-fallback { display:flex; align-items:center; justify-content:center; background:#2a3350; color:#cbd6ff; font-weight:700; }
.contacts { display:flex; flex-direction:column; gap:6px; }
.contact { display:flex; align-items:center; gap:10px; padding:10px; border-radius:10px; cursor:pointer; border:1px solid transparent; }
.contact:hover { background:#1b2233; border-color:var(--border); }
.contact.active { background:#1d2540; border-color: var(--primary); }
.contact img { width:28px; height:28px; border-radius:50%; object-fit:cover; }
.requests { display:flex; flex-direction:column; gap:10px; }
.request-send { display:flex; gap:8px; }
.request-send input { flex:1; padding:10px; border-radius:8px; border:1px solid var(--border); background:var(--bg-soft); color:var(--text); }
.request-send button { padding:10px 12px; border-radius:8px; border:1px solid var(--border); background: transparent; color: var(--text); }
.request { display:flex; align-items:center; gap:12px; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background: rgba(255,255,255,0.02); }
.request .req-right { margin-left:auto; display:flex; align-items:center; gap:8px; }
.request:hover { background: rgba(255,255,255,0.04); }
.request .actions { display:flex; gap:8px; margin-left:auto; }
.request .actions button { padding:6px 10px; border-radius:8px; border:1px solid var(--border); background: transparent; color: var(--text); font-size:12px; }
.request .actions button.danger { border-color:#59333a; color:#ff9aa7; }
.request .status { color: var(--muted); font-size:12px; padding:2px 8px; border-radius:999px; border:1px solid var(--border); background: transparent; }
.request .status.accepted { color:#98e6b9; border-color:#2a5c49; }
.request .status.declined { color:#ff9aa7; border-color:#59333a; }
.unread { background:#ff6b6b; color:white; border-radius:999px; padding:2px 8px; font-size:12px; animation: pop 200ms ease; }

@keyframes pop {
  0% { transform: scale(0.8); opacity: 0.6; }
  100% { transform: scale(1); opacity: 1; }
}

.chat-area { flex:1; display:flex; overflow:hidden; }
.chat-window { flex:1; display:flex; flex-direction:column; overflow:hidden; }
.chat-window .header { padding:12px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:12px; background: linear-gradient(180deg, var(--panel), var(--panel-2)); }
.chat-window .header .title { font-weight:600; }
.chat-window .header .subtitle { color: var(--muted); font-size:12px; }
.chat-window .messages { flex:1; overflow:auto; padding:16px; display:flex; flex-direction:column; gap:14px; min-height:0; }

/* message rows */
.message-row { display:flex; align-items:flex-start; gap:15px; width:100%; }
.message-row.other { justify-content:flex-start; }
.message-row.me { justify-content:flex-end; }
.avatar-holder { display:flex; align-items:flex-start; justify-content:center; width:32px; }
.avatar.small { width:32px; height:32px; margin-top: 6px; margin-bottom: 10px;}
.message-content { display:flex; flex-direction:column; width:fit-content; max-width:min(75%, 640px); }
.message-row.me .message-content { align-items:flex-end; }
.message-row.other .message-content { align-items:flex-start; }
.bubble-row { display:flex; align-items:flex-start; gap:6px; flex-wrap:nowrap; }
.bubble-row.me { justify-content:flex-end; }
.bubble-row.other { justify-content:flex-start; }
.message-actions { position:relative; display:flex; justify-content:flex-end; align-items:flex-start; }
.message-actions.inline { position:relative; align-self:flex-start; white-space:nowrap; order:0; }
.bubble-row.me .message-actions.inline { order:0; }
.bubble-row.me .bubble { order:1; }
/* place other-user menu button to the right of their bubble */
.bubble-row.other .bubble { order:0; }
.bubble-row.other .message-actions.inline { order:1; }
.menu-btn { background:transparent; color:var(--text); padding:4px 6px; cursor:pointer; margin-top: 4px;}
.menu { position:absolute; right:0; display:flex; flex-direction:column; background:var(--panel); border:1px solid var(--border); border-radius:8px; box-shadow:0 6px 20px rgba(0,0,0,0.35); overflow:hidden; z-index:3; }
.menu.bottom { top:28px; }
.menu.top { bottom:28px; }
.menu button { background:transparent; border:none; color:var(--text); padding:8px 12px; text-align:left; cursor:pointer; }
.menu button:hover { background:#1b2233; }
.menu .danger { color:#ff9aa7; }

.bubble { display:inline-block; background:#202a4a; padding:7px 12px; border-radius:14px; border:1px solid rgba(255,255,255,0.06); box-shadow: 0 2px 8px rgba(0,0,0,0.25); max-width:100%; }
.bubble.me { background:linear-gradient(180deg, var(--primary), var(--primary-600)); margin-left:auto; }
.bubble .text { white-space:pre-wrap; }
.time { margin-top:4px; font-size:10px; color:#d0d6ee; opacity:0.8; }
.time.left { text-align:left; }
.time.right { text-align:right; }
.time-divider { display:flex; align-items:center; justify-content:center; gap:12px; color:var(--muted); font-size:11px; margin:8px 0; }
.time-divider::before, .time-divider::after { content:""; height:1px; flex:1; background:var(--border); opacity:.6; }
.time-divider span { background:transparent; padding:2px 8px; border-radius:999px; }
.bubble .cipher { color:#bbb; font-size:12px; }
.composer { position:relative; display:flex; gap:10px; padding:12px; border-top:1px solid var(--border); background: var(--panel); }
.reply-bar { position:absolute; bottom:100%; left:12px; right:12px; display:flex; align-items:center; justify-content:space-between; gap:10px; padding:6px 10px; border:1px dashed var(--border); border-radius:8px; margin-bottom:6px; color:var(--muted); background: rgba(0,0,0,0.2); backdrop-filter: blur(2px); z-index:2; }
.reply-inline { 
  display:flex; gap:6px; align-items:center; 
  padding:6px 8px; margin-bottom:6px; 
  border-radius:8px; 
  background: rgba(255,255,255,0.04); color:var(--muted); 
  font-size:12px; line-height:1.2; max-width:100%;
}
.reply-inline .reply-label { opacity:.75; }
.reply-inline .reply-quote { 
  color:#dfe6ff; font-weight:500; 
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap; 
}
.bubble.me .reply-inline { 
  background: rgba(255,255,255,0.12); 
  border-left-color: rgba(255,255,255,0.35); 
  color: rgba(255,255,255,0.85);
}
.bubble.me .reply-inline .reply-quote { color:#fff; }
.composer input { flex:1; padding:12px; border-radius:10px; border:1px solid var(--border); background:var(--bg-soft); color:var(--text); }
.composer > button { padding:12px 14px; border-radius:10px; margin-right: 10px; border:1px solid transparent; background: linear-gradient(180deg, var(--primary), var(--primary-600)); color:#fff; font-weight:600; }
/* unify composer Send and reply Cancel buttons */
.composer button, .reply-bar .btn { 
  height:40px; width:80px; display:inline-flex; align-items:center; justify-content:center;
}
.reply-bar .btn { 
  padding:12px 14px; border-radius:10px; border:1px solid transparent; background: linear-gradient(180deg, var(--primary), var(--primary-600)); color:#fff; font-weight:600;
}
.typing { padding: 6px 12px; font-size: 12px; color:var(--muted); }

/* typing bubble */
.bubble.typing { display:inline-flex; align-items:center; justify-content:center; gap:6px; width:56px; height:28px; padding:0; border-radius:14px; background:#202a4a; border:1px solid rgba(255,255,255,0.06); box-sizing:border-box; vertical-align:middle; }
.bubble.typing .dot { display:block; width:6px; height:6px; border-radius:50%; background:#d0d6ee; opacity:0.8; animation: typingPulse 1s infinite ease-in-out; }
.bubble.typing .dot:nth-child(2) { animation-delay: .15s; }
.bubble.typing .dot:nth-child(3) { animation-delay: .3s; }
@keyframes typingPulse { 0%, 80%, 100% { transform: translateY(0); opacity:.4; } 40% { transform: translateY(-3px); opacity:1; } }

/* subtle scrollbars */
.chat-window .messages::-webkit-scrollbar { width:10px; }
.chat-window .messages::-webkit-scrollbar-thumb { background:#2a3350; border-radius:10px; }

@media (max-width: 1024px) {
  .dashboard { flex-direction:column; }
  .sidebar { width:100%; border-right:none; border-bottom:1px solid var(--border); }
}

@media (min-width: 1200px) {
  .dashboard { width: 100%; max-width: 100%; margin: 0; }
}

@media (max-width: 520px) {
  .login-card { padding:20px; border-radius:14px; }
}

@media (max-width: 768px) {
  .dashboard { flex-direction:column; }
  .sidebar { width:100%; border-right:none; border-bottom:1px solid #333; }
}

@media (max-width: 520px) {
  .message-content { max-width: 90%; }
}
